<!DOCTYPE html>
<html lang="ja-JP">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    
    <title>Nobwak&#39;s Lair  | [python] WindowsでのPython2</title>
    <meta name="HandheldFriendly" content="True">
    <meta name="MobileOptimized" content="320">

    <meta name="viewport" content="width=device-width,minimum-scale=1">
    <meta name="generator" content="Hugo 0.54.0" />
    
    
      <META NAME="ROBOTS" CONTENT="NOINDEX, NOFOLLOW">
    

    
    
      <link href="/dist/css/app.d98f2eb6bcd1eaedb7edf166bd16af26.css" rel="stylesheet">
    

    

    
      
    

    

    <meta property="og:title" content="[python] WindowsでのPython2" />
<meta property="og:description" content="Pythonが面白くてしょうがいない。 のだが、Windowsで使った場合、文字コードとか改行コードとかパスのデリミタのせいでいろいろと手間が" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://nobwak.github.io/posts/2013-05-17-python_windows%E3%81%A7%E3%81%AEpython2/" />
<meta property="article:published_time" content="2013-05-17T22:42:14&#43;09:00"/>
<meta property="article:modified_time" content="2013-05-17T22:42:14&#43;09:00"/>

<meta itemprop="name" content="[python] WindowsでのPython2">
<meta itemprop="description" content="Pythonが面白くてしょうがいない。 のだが、Windowsで使った場合、文字コードとか改行コードとかパスのデリミタのせいでいろいろと手間が">


<meta itemprop="datePublished" content="2013-05-17T22:42:14&#43;09:00" />
<meta itemprop="dateModified" content="2013-05-17T22:42:14&#43;09:00" />
<meta itemprop="wordCount" content="1177">



<meta itemprop="keywords" content="" />
<meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="[python] WindowsでのPython2"/>
<meta name="twitter:description" content="Pythonが面白くてしょうがいない。 のだが、Windowsで使った場合、文字コードとか改行コードとかパスのデリミタのせいでいろいろと手間が"/>

  </head>

  <body class="ma0 avenir bg-near-white">

    
   
  

  <header>
    <div class="bg-black">
      <nav class="pv3 ph3 ph4-ns" role="navigation">
  <div class="flex-l justify-between items-center center">
    <a href="https://nobwak.github.io/" class="f3 fw2 hover-white no-underline white-90 dib">
      Nobwak&#39;s Lair
    </a>
    <div class="flex-l items-center">
      

      
      











    </div>
  </div>
</nav>

    </div>
  </header>



    <main class="pb7" role="main">
      
  
  <article class="flex-l flex-wrap justify-between mw8 center ph3">

    <header class="mt4 w-100">
      <p class="f6 b helvetica tracked">
          
        POSTS
      </p>
      <h1 class="f1 athelas mb1">[python] WindowsでのPython2</h1>
      
      <time class="f6 mv4 dib tracked" datetime="2013-05-17T22:42:14&#43;09:00">May 17, 2013</time>      
      
      
    </header>

    <section class="nested-copy-line-height lh-copy serif f4 nested-links nested-img mid-gray pr4-l w-two-thirds-l">

<p>Pythonが面白くてしょうがいない。<br />
のだが、Windowsで使った場合、文字コードとか改行コードとかパスのデリミタのせいでいろいろと手間がかかる。<br />
Windows固有の手間をここにまとめる。</p>

<p>なお、私の使っているのはPython2。<br />
<code>&lt;br /&gt;
ActivePython 2.7.2.5 (ActiveState Software Inc.) based on&lt;br /&gt;
Python 2.7.2 (default, Jun 24 2011, 12:22:14) [MSC v.1500 64 bit (AMD64)] on win32</code></p>

<h3 id="span-style-text-decoration-underline-文字コード設定-span"><span style="text-decoration: underline;">文字コード設定</span></h3>

<p>Python2を使っていて扱うファイルがShift-JISばかりなら、PythonもShift-JISで通したほうが楽。<br />
だってほら、いちいち変換とか面倒ですよ。</p>

<p>Pythonスクリプトファイルの1行目あるいは2行目には以下を記載する。</p>

<p><code># coding: ms932</code></p>

<p># -*- coding:という書式もあるがemacsを使わないならこれでよい。<br />
詳細は下記リンク<br />
 <a href=" http://docs.python.org/2/reference/lexical_analysis.html#encoding-declarations" target="_blank"><a href="http://docs.python.org/2/reference/lexical_analysis.html#encoding-declarations">http://docs.python.org/2/reference/lexical_analysis.html#encoding-declarations</a></a></p>

<h2 id="span-style-text-decoration-underline-default-encodingの設定-span"><span style="text-decoration: underline;">default encodingの設定</span></h2>

<p>デフォルトのencodingもms932にしておく。<br />
いま現在のencodingを確かめるにはimport sysしてからsys.getdefaultencoding()する。<br />
何もしていなければasciiのはず。</p>

<pre><code class="language-console">&gt;&gt;&gt; import sys
&gt;&gt;&gt; sys.getdefaultencoding()
'ascii'
&gt;&gt;&gt;
</code></pre>

<p>C:\Python27\Lib\の下にsitecustomize.pyを作って以下の内容を書き込む。</p>

<pre><code class="language-console">import sys
sys.setdefaultencoding('cp932')
</code></pre>

<p>もう一度確かめればデフォルトのencodingが変わっていると分かる。</p>

<pre><code class="language-console">&gt;&gt;&gt; import sys
&gt;&gt;&gt; sys.getdefaultencoding()
'cp932'
&gt;&gt;&gt;
</code></pre>

<h3 id="span-style-text-decoration-underline-パスの扱い方-頭にrを付ける-span"><span style="text-decoration: underline;">パスの扱い方（頭にrを付ける）</span></h3>

<p>Windowsのパス表記はバックスラッシュを使うが、これをそのまま使うとエスケープシーケンスとして扱われてしまう。<br />
そこでrを頭につける。<br />
するとrawリテラルとして扱ってくれる。</p>

<p><code>&gt;&gt;&gt; print 'c:\nowhere'&lt;br /&gt;
c:&lt;br /&gt;
owhere&lt;br /&gt;
&gt;&gt;&gt; print r'c:\nowhere'&lt;br /&gt;
c:\nowhere&lt;br /&gt;
&gt;&gt;&gt;</code></p>

<p><a href="http://docs.python.org/2/reference/lexical_analysis.html#string-literals" target="_blank"><a href="http://docs.python.org/2/reference/lexical_analysis.html#string-literals">http://docs.python.org/2/reference/lexical_analysis.html#string-literals</a></a></p>

<h3 id="span-style-text-decoration-underline-windowsでのcsv書き込み-改行コードに注意-span"><span style="text-decoration: underline;">WindowsでのCSV書き込み。改行コードに注意。</span></h3>

<p>Windows上PythonからCSV書き出し→ExcelなどWindowsの各種プログラムで開く→一行ごとに空行ができている＼(^o^)／<br />
CSV書き出し時改行コードのデフォルトが\r\nになっているせい。<br />
下記のように改行コードを指定すればOK。<br />
なお読み込みのときは指定不要。<br />
 <a href=" http://docs.python.jp/2/library/csv.html#csv.Dialect.lineterminator" target="_blank"><a href="http://docs.python.jp/2/library/csv.html#csv.Dialect.lineterminator">http://docs.python.jp/2/library/csv.html#csv.Dialect.lineterminator</a></a></p>

<p><code>import csv&lt;br /&gt;
csvhandler = csv.writer(open(r'C:\nowhere\output.csv','w'),delimiter=',',lineterminator=&quot;\n&quot;)</code></p>

<h3 id="span-style-text-decoration-underline-shift-jisでのsqlite3-span"><span style="text-decoration: underline;">Shift-JISでのsqlite3</span></h3>

<p>SQLite3のTEXTデータタイプはデフォルトでUTF-8。<br />
SQLite3コネクションオブジェクトの.text_factoryアトリビュートをstrにすると、バイトストリングとして扱ってくれる。<br />
 <a href=" http://docs.python.org/2/library/sqlite3.html#sqlite3.Connection.text_factory" target="_blank"><a href="http://docs.python.org/2/library/sqlite3.html#sqlite3.Connection.text_factory">http://docs.python.org/2/library/sqlite3.html#sqlite3.Connection.text_factory</a></a></p>

<p><code>import sqlite&lt;br /&gt;
conn = sqlite3.connect(dbfile)&lt;br /&gt;
conn.text_factory = str</code></p>

<h3 id="span-style-text-decoration-underline-pylab-matplotlib-のグラフで日本語表示-span"><span style="text-decoration: underline;">pylab(Matplotlib)のグラフで日本語表示</span></h3>

<p>pylabで作ったグラフは、UTF-8でないとダメなようだ。<br />
こればかりはunicodeにエンコードしてpylabに入力する。<br />
しかしUTF-８であっても、そのままでは日本語を表示してくれない。<br />
下記のようにフォントを指定する。</p>

<p><code>import pylab&lt;br /&gt;
pylab.rcParams['font.family'] = 'VL Gothic'&lt;br /&gt;
pylab.rcParams['font.size'] = 12</code></p>

<p><span style="text-decoration: underline;">更新履歴</span></p>

<p>2013/5/17 初版<br />
2013/5/10 sqlite3のtextでUTF-8でなくバイトストリングを扱う方法を追記<br />
2013/5/24 pylabグラフで日本語使うときの注意を追記<br />
2013/9/12 default encodingの件を追加</p>
<ul class="pa0">
  
</ul>
<div class="mt6">
        
      </div>
    </section>

    <aside class="w-30-l mt6-l">




</aside>

  </article>

    </main>
    <footer class="bg-black bottom-0 w-100 pa3" role="contentinfo">
  <div class="flex justify-between">
  <a class="f4 fw4 hover-white no-underline white-70 dn dib-ns pv2 ph3" href="https://nobwak.github.io/" >
    &copy; 2019 Nobwak&#39;s Lair
  </a>
    <div>










</div>
  </div>
</footer>

    

  <script src="/dist/js/app.3fc0f988d21662902933.js"></script>


  </body>
</html>
